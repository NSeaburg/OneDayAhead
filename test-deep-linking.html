<!DOCTYPE html>
<html>
<head>
    <title>Test Deep Linking Flow</title>
</head>
<body>
    <h1>Test LTI Deep Linking Request</h1>
    <p>This page simulates a Canvas Deep Linking request to test the JWT claims debugging.</p>
    
    <form id="ltiForm" method="POST" action="http://localhost:5000/api/lti/launch">
        <input type="hidden" name="id_token" id="idToken" value="">
        <input type="hidden" name="state" value="test-state-123">
        <button type="submit">Test Deep Linking Launch</button>
    </form>

    <h2>Development Test (No JWT)</h2>
    <p>In development mode, the auth middleware should create mock claims.</p>
    <button onclick="testDevMode()">Test Dev Mode Launch</button>

    <script>
        // This would normally be a JWT from Canvas
        // For testing, we'll submit without a token to trigger development mode
        function testDevMode() {
            fetch('http://localhost:5000/api/lti/launch', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    state: 'dev-test-state'
                })
            })
            .then(res => res.text())
            .then(data => {
                console.log('Response:', data);
                alert('Check server logs for debug output');
            })
            .catch(err => {
                console.error('Error:', err);
                alert('Error: ' + err.message);
            });
        }
    </script>
</body>
</html>